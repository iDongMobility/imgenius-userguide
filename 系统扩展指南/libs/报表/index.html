<!DOCTYPE html>

<html>
<head>
    <meta charset="utf-8" />
    <title>用户信息表</title>
    <script src="jquery-1.11.1.min.js" type="text/javascript"></script>
</head>
<body>
    <h2>用户信息表</h2>
    <div id="form"></div>
    <script>
        $(document).ready(function () {
            var report = new Report();
            // 固定如此
            window.customReportObj = report;
            report.PostToServer("GetAll", report.parentObj.GetQueryCondition(), function (_result) {
                if (_result.IsSuccess) {
                    Draw(_result.Data);
                }
                else {
                    console.error(_result.Msg);
                }
            });
        });

        // 绘制表格
        function Draw(_data) {
            var htmls = [];
            htmls.push("<table>");
            htmls.push("    <thead>");
            htmls.push("        <tr>");
            htmls.push("            <th>姓名</th>");
            htmls.push("            <th>登录名</th>");
            htmls.push("            <th>邮箱</th>");
            htmls.push("        </tr>");
            htmls.push("    </thead>");
            htmls.push("<tbody>");

            for (var i = 0; i < _data.length; i++) {
                var user = _data[i];
                htmls.push("<tr>");
                htmls.push("    <td>" + user.Name + "</td>");
                htmls.push("    <td>" + user.LoginID + "</td>");
                htmls.push("    <td>" + user.EMail + "</td>");
                htmls.push("</tr>");
            }
            
            htmls.push("</tbody>");
            htmls.push("</table>");
            $("#form").html("");
            $("#form").append(htmls.join(""));
        }

        // 构造函数
        function Report() {
            // 固定如此
            this.parentObj = window.parent.customReportIndex;
        }

        // 后台查询
        Report.prototype.PostToServer = function (_operateType, _parameter, _callback) {
            this.parentObj.PostToServer(_operateType, _parameter, _callback);
        }

        // 打开或刷新时调用
        Report.prototype.Query = function () {
            this.PostToServer("Query", this.parentObj.GetQueryCondition(), function (_result) {
                if (_result.IsSuccess) {
                    Draw(_result.Data);
                }
                else {
                    console.error(_result.Msg);
                }
            });
        }
        
    </script>
</body>
</html>